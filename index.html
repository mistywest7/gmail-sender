<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title></title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,400;0,700;1,400;1,700&display=swap"
        rel="stylesheet">
  <meta name="description" content="">

  <meta property="og:title" content="">
  <meta property="og:type" content="">
  <meta property="og:url" content="">
  <meta property="og:image" content="">
  <meta property="og:image:alt" content="">

  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" href="/icon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="icon.png">

  <link rel="manifest" href="site.webmanifest">
  <meta name="theme-color" content="#fafafa">
</head>

<body>
<header>
  <div class="Header">
    <h1>VEHICLE OVERVIEW</h1>
  </div>

</header>
<main class="container">

  <div class="wrapper">
    <div class="section">
      <div class="system-check">
        <div class="check-one">
          <div class="checkbox">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd"
                    d="M12 24C18.6274 24 24 18.6274 24 12C24 5.37258 18.6274 0 12 0C5.37258 0 0 5.37258 0 12C0 18.6274 5.37258 24 12 24ZM17.6647 10.1879C18.0446 9.78705 18.0276 9.15411 17.6268 8.77419C17.2259 8.39428 16.593 8.41125 16.2131 8.8121L10.8574 14.463L8.81882 12.3121C8.43891 11.9112 7.80597 11.8943 7.40512 12.2742C7.00427 12.6541 6.9873 13.287 7.36721 13.6879L10.1315 16.6046C10.3204 16.8038 10.5828 16.9167 10.8574 16.9167C11.1319 16.9167 11.3943 16.8038 11.5832 16.6046L17.6647 10.1879Z"
                    fill="#9499C3"/>
            </svg>

            <div class="txt">
              <p>ALL SYSTEM CHECK</p>
              <span>Normal</span>
            </div>
          </div>
        </div>

      </div>
      <div class="system-check">
        <div class="check-one">
          <div class="checkbox">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd"
                    d="M12 24C18.6274 24 24 18.6274 24 12C24 5.37258 18.6274 0 12 0C5.37258 0 0 5.37258 0 12C0 18.6274 5.37258 24 12 24ZM17.6647 10.1879C18.0446 9.78705 18.0276 9.15411 17.6268 8.77419C17.2259 8.39428 16.593 8.41125 16.2131 8.8121L10.8574 14.463L8.81882 12.3121C8.43891 11.9112 7.80597 11.8943 7.40512 12.2742C7.00427 12.6541 6.9873 13.287 7.36721 13.6879L10.1315 16.6046C10.3204 16.8038 10.5828 16.9167 10.8574 16.9167C11.1319 16.9167 11.3943 16.8038 11.5832 16.6046L17.6647 10.1879Z"
                    fill="#9499C3"/>
            </svg>

            <div class="txt">
              <p>RENDEZVOUS BURN SLOW</p>
              <span>Normal</span>
            </div>
          </div>
        </div>

      </div>
      <div class="system-check">
        <div class="check-one">
          <div class="checkbox">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd"
                    d="M12 24C18.6274 24 24 18.6274 24 12C24 5.37258 18.6274 0 12 0C5.37258 0 0 5.37258 0 12C0 18.6274 5.37258 24 12 24ZM17.6647 10.1879C18.0446 9.78705 18.0276 9.15411 17.6268 8.77419C17.2259 8.39428 16.593 8.41125 16.2131 8.8121L10.8574 14.463L8.81882 12.3121C8.43891 11.9112 7.80597 11.8943 7.40512 12.2742C7.00427 12.6541 6.9873 13.287 7.36721 13.6879L10.1315 16.6046C10.3204 16.8038 10.5828 16.9167 10.8574 16.9167C11.1319 16.9167 11.3943 16.8038 11.5832 16.6046L17.6647 10.1879Z"
                    fill="#9499C3"/>
            </svg>

            <div class="txt">
              <p>PREPARE RENDEZVOUS BURN</p>
              <span>Normal</span>
            </div>
          </div>
        </div>

      </div>
      <div class="system-check">
        <div class="check-one">
          <div class="checkbox">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd"
                    d="M12 24C18.6274 24 24 18.6274 24 12C24 5.37258 18.6274 0 12 0C5.37258 0 0 5.37258 0 12C0 18.6274 5.37258 24 12 24ZM17.6647 10.1879C18.0446 9.78705 18.0276 9.15411 17.6268 8.77419C17.2259 8.39428 16.593 8.41125 16.2131 8.8121L10.8574 14.463L8.81882 12.3121C8.43891 11.9112 7.80597 11.8943 7.40512 12.2742C7.00427 12.6541 6.9873 13.287 7.36721 13.6879L10.1315 16.6046C10.3204 16.8038 10.5828 16.9167 10.8574 16.9167C11.1319 16.9167 11.3943 16.8038 11.5832 16.6046L17.6647 10.1879Z"
                    fill="#79F74B"/>
            </svg>

            <div class="txt">
              <p>THERMAL SHIELD</p>
              <span class="active">Applied</span>
            </div>
          </div>
        </div>

      </div>
      <div class="system-check">
        <div class="check-one">
          <div class="checkbox">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd"
                    d="M12 24C18.6274 24 24 18.6274 24 12C24 5.37258 18.6274 0 12 0C5.37258 0 0 5.37258 0 12C0 18.6274 5.37258 24 12 24ZM17.6647 10.1879C18.0446 9.78705 18.0276 9.15411 17.6268 8.77419C17.2259 8.39428 16.593 8.41125 16.2131 8.8121L10.8574 14.463L8.81882 12.3121C8.43891 11.9112 7.80597 11.8943 7.40512 12.2742C7.00427 12.6541 6.9873 13.287 7.36721 13.6879L10.1315 16.6046C10.3204 16.8038 10.5828 16.9167 10.8574 16.9167C11.1319 16.9167 11.3943 16.8038 11.5832 16.6046L17.6647 10.1879Z"
                    fill="#9499C3"/>
            </svg>

            <div class="txt">
              <p>BURN Go/No-GO</p>
              <span>Normal</span>
            </div>
          </div>
        </div>
      </div>
      <div class="system-check">
        <div class="check-one">
          <div class="checkbox">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd"
                    d="M12 24C18.6274 24 24 18.6274 24 12C24 5.37258 18.6274 0 12 0C5.37258 0 0 5.37258 0 12C0 18.6274 5.37258 24 12 24ZM17.6647 10.1879C18.0446 9.78705 18.0276 9.15411 17.6268 8.77419C17.2259 8.39428 16.593 8.41125 16.2131 8.8121L10.8574 14.463L8.81882 12.3121C8.43891 11.9112 7.80597 11.8943 7.40512 12.2742C7.00427 12.6541 6.9873 13.287 7.36721 13.6879L10.1315 16.6046C10.3204 16.8038 10.5828 16.9167 10.8574 16.9167C11.1319 16.9167 11.3943 16.8038 11.5832 16.6046L17.6647 10.1879Z"
                    fill="#EA7B15"/>
            </svg>

            <div class="txt">
              <p>POWER COMPLETION</p>
              <span class="active">Awaiting</span>
            </div>
          </div>
        </div>
      </div>
      <div class="system-check">
        <div class="check-one">
          <div class="checkbox">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd"
                    d="M12 24C18.6274 24 24 18.6274 24 12C24 5.37258 18.6274 0 12 0C5.37258 0 0 5.37258 0 12C0 18.6274 5.37258 24 12 24ZM17.6647 10.1879C18.0446 9.78705 18.0276 9.15411 17.6268 8.77419C17.2259 8.39428 16.593 8.41125 16.2131 8.8121L10.8574 14.463L8.81882 12.3121C8.43891 11.9112 7.80597 11.8943 7.40512 12.2742C7.00427 12.6541 6.9873 13.287 7.36721 13.6879L10.1315 16.6046C10.3204 16.8038 10.5828 16.9167 10.8574 16.9167C11.1319 16.9167 11.3943 16.8038 11.5832 16.6046L17.6647 10.1879Z"
                    fill="#9499C3"/>
            </svg>

            <div class="txt">
              <p>STATION DECK CHECK</p>
              <span>Normal</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="footerbuttons">
      <button class="system">SYSTEM</button>
      <button class="cabin">CABIN</button>
    </div>
  </div>
  <section>
    <div class="cell">
      <div class="gauge-container">
        <svg class="gauge" viewBox="0 0 100 100">
          <circle class="gauge-circle" cx="50" cy="50" r="40"></circle>
          <circle class="gauge_tix" cx="50" cy="50" r="45"></circle>
          <circle class="gauge_fill" cx="50" cy="50" r="40" stroke-dasharray="251.2" stroke-dashoffset="251.2"></circle>
        </svg>
        <span class="value-display">
          <span class="gauge_labletop">PPO2</span>
          <span class="value" id="gagueValue">2.69</span>
        <span class="unit">psia</span>
      </div>
    </div>
    </div>
  </section>
  <div class="feedback">
    <button id="auth-button">Login</button>
    <button id="signout_button">Sign Up</button>
    <form id="emailForm">
      <label for="to">Email address</label>
      <input id="to" type="email" name="email" placeholder="Email Address" required>
      <label for="subject">Subject</label>
      <input id="subject" type="text" name="subject" placeholder="Subject" required>
      <label for="message">Message</label>
      <textarea id="message" name="message" placeholder="Message" required></textarea>
      <button id="send-button" type="submit">Send Message</button>
    </form>

  </div>
</main>

<script src="https://apis.google.com/js/api.js"></script>
<script src="js/app.js"></script>
<script>console.log("1) СТАРТ СКРИПТА: загружен api.js, переходим к handleClientLoad().");

// CLIENT_ID из Google Cloud Console (Тип: Web application)
const CLIENT_ID = '316266346612-v1fji1khpru90g29kvlsc02rqlcr5v7h.apps.googleusercontent.com';
// Нужные разрешения (scopes) для отправки писем
const SCOPES = 'https://www.googleapis.com/auth/gmail.compose';

// Получаем ссылки на кнопки
const authorizeButton = document.getElementById('auth-button');
const signoutButton = document.getElementById('signout-button');
const sendButton = document.getElementById('send-button');

/**
 * Функция вызывается после загрузки api.js
 */
function handleClientLoad() {
  console.log("2) handleClientLoad(): теперь загружаем client:auth2...");
  // Загружаем нужные модули gapi
  gapi.load('client:auth2', initClient);
}

/**
 * Инициализация клиента API
 */
async function initClient() {
  console.log("3) initClient(): начинаем инициализацию gapi.client...");

  try {
    // Подключаем discoveryDocs для Gmail v1, чтобы получить gapi.client.gmail
    await gapi.client.init({
      clientId: CLIENT_ID,
      scope: SCOPES,
      discoveryDocs: ["https://www.googleapis.com/discovery/v1/apis/gmail/v1/rest"]
    });

    console.log("4) initClient(): gapi.client.init() завершилась УСПЕШНО.");

    // Подписываемся на изменения статуса авторизации
    gapi.auth2.getAuthInstance().isSignedIn.listen(updateSignInStatus);

    // Проверяем текущий статус (вошёл / не вошёл)
    const isSignedIn = gapi.auth2.getAuthInstance().isSignedIn.get();
    console.log("5) initClient(): Текущий статус isSignedIn =", isSignedIn);
    updateSignInStatus(isSignedIn);

  } catch (error) {
    console.error("3.1) initClient(): ОШИБКА при gapi.client.init:", error);
  }
}

/**
 * Проверяет статус входа и отображает/скрывает кнопки
 */
function updateSignInStatus(isSignedIn) {
  console.log("6) updateSignInStatus(): isSignedIn =", isSignedIn);

  if (isSignedIn) {
    // Пользователь вошёл
    console.log("   -> Пользователь авторизован, показываем кнопки 'Выйти' и 'Отправить'.");
    authorizeButton.style.display = 'none';
    signoutButton.style.display = 'inline-block';
    sendButton.style.display = 'inline-block';
  } else {
    // Пользователь НЕ вошёл
    console.log("   -> Пользователь НЕ авторизован, показываем кнопку 'Войти'.");
    authorizeButton.style.display = 'inline-block';
    signoutButton.style.display = 'none';
    sendButton.style.display = 'none';
  }
}

/**
 * Нажатие кнопки "Войти"
 */
authorizeButton.onclick = () => {
  const test = gapi.auth2.getAuthInstance();
  console.log(test)
  console.log(gapi.auth2)
  console.log("7) authorizeButton: Нажата кнопка Войти, вызываем signIn()...");
  gapi.auth2.getAuthInstance().signIn().then(() => {
    console.log("   -> signIn() fulfilled!");
  }).catch(err => {
    console.error("   -> signIn() ОШИБКА:", err);
  });
};

/**
 * Нажатие кнопки "Выйти"
 */
signoutButton.onclick = () => {
  console.log("8) signoutButton: Нажата кнопка Выйти, вызываем signOut()...");
  gapi.auth2.getAuthInstance().signOut().then(() => {
    console.log("   -> signOut() fulfilled!");
  }).catch(err => {
    console.error("   -> signOut() ОШИБКА:", err);
  });
};

/**
 * Нажатие кнопки "Отправить тестовое письмо"
 */
sendButton.onclick = async () => {
  console.log("9) sendButton: Нажата кнопка 'Отправить письмо'");

  // Проверим ещё раз, что пользователь авторизован
  const isSignedIn = gapi.auth2.getAuthInstance().isSignedIn.get();
  console.log("   -> isSignedIn перед отправкой =", isSignedIn);
  if (!isSignedIn) {
    console.warn("   -> Пользователь не авторизован, отправка отменена.");
    return;
  }

  // Формируем простое письмо
  const to = 'test@example.com';
  const subject = 'Test from Gmail API';
  const message = 'Привет! Это тестовое письмо, отправленное из Gmail API.';
  const email = [
    `To: ${to}`,
    'Content-Type: text/plain; charset="UTF-8"',
    `Subject: ${subject}`,
    '',
    message
  ].join('\r\n');

  // Кодируем Base64 URL-SAFE
  const base64EncodedEmail = btoa(email)
    .replace(/\+/g, '-')
    .replace(/\//g, '_');

  console.log("   -> Закодированное письмо (первые 50 символов):", base64EncodedEmail.slice(0, 50) + "...");

  try {
    console.log("   -> Вызываем gapi.client.gmail.users.messages.send...");
    const response = await gapi.client.gmail.users.messages.send({
      userId: 'me',
      resource: {
        raw: base64EncodedEmail
      }
    });

    console.log("   -> УСПЕХ! Ответ сервера:", response);
    alert('Письмо успешно отправлено!');
  } catch (err) {
    console.error("   -> ОШИБКА при отправке письма:", err);
    alert('Ошибка при отправке письма (см. консоль).');
  }
};

// Запускаем процесс после загрузки
window.onload = () => {
  console.log("1.1) window.onload -> вызываем handleClientLoad()");
  handleClientLoad();
};
</script>
</body>

</html>
